#!/usr/bin/env bash

# params:
#   - prefix input
#   - expected output
test_prefix() {
    echo "---------------------------------------------------------------------"
    echo "Input for prefix test is: $1"
    echo "$1" | ./aprox -p
    echo "EXPECTED OUTPUT: $2"
    echo "Return code is: $?"
}

# params:
#   - infix input
#   - expected output
test_infix() {
    echo "---------------------------------------------------------------------"
    echo "Input for infix test is: $1"
    echo "$1" | ./aprox
    echo "EXPECTED OUTPUT: $2"
    echo "Return code is: $?"
}


echo "##########################################################################################################"
echo "################################################ POSTFIX #################################################"
echo "##########################################################################################################"
echo "################################################ NUMBERS #################################################"
test_prefix "2.58 2 * 8 / 3.5 *" "2.2575"
test_prefix "0.2 .2 *" "0.04"
test_prefix "0.35" "0.35"
test_prefix "5       3+1./" "8"
test_prefix "0.5.3 2 *" "ERROR"
test_prefix "3 5 * +" "ERROR"

echo "################################################ DISTRIBUTIONS ##################################################"
test_prefix "0 100 ~ 3 * 10 -" "-10 ... 290"
test_prefix "5 20 u 0 10 ~ *" "0 ... 200"
test_prefix "0 4 u 2 - 10 *" "-20 ... 20"
test_prefix "8 ~ 20 0 /" "ERROR"
test_prefix "7 5 20 ~ 20 - /" "ERROR"

echo "##########################################################################################################"
echo "################################################ INFIX ###################################################"
echo "##########################################################################################################"

echo "################################################ NUMBERS #################################################"
test_infix "2.58 * 2    /  8 * 3.5" "2.2575"
test_infix "0.2  *  .2" "0.04"
test_infix ".35" "0.35"
test_infix "5         + 3 / 1." "8"
test_infix "5 + 5 +" "ERROR"
test_infix " 0.5.3 * 2" "ERROR"
test_infix "3 * 5 +" "ERROR"
test_infix "-(-(-(-2)))" "2"
test_infix "(-2 + (-2)) * (-2 * (-2))" "-16" 
test_infix "2 + (10 + 4) / 2 * 3" "23"
test_infix "(3 + 3 + 3) * (3/2 + 1)" "22.5"
test_infix "(3 + 3 + 3) / ( 3  /  2 - 1.5)" "ERROR"

echo "################################################ DISTRIBUTIONS ##################################################"
test_infix "2 * 3 ~ 10 / 2" "3 ... 10"
test_infix "100 ~ 200 / 10" "10 ... 20"
test_infix "(-3) ~ 10" "-3 ... 10"
test_infix "(6 /2 * 3) u (2 * 5 * 2)" "9 ... 20"
test_infix "3 + 5 + 3 ~ 10 * 2" "14 ... 28"
test_infix "(-5) u (-2)" "-5 ... -2"
test_infix "10 ~ 10" "10 .. 10"
test_infix "10 u 10" "10 .. 10"
test_infix "10 ~ 5" "ERROR"
test_infix "10 n 5" "ERROR"
test_infix "10 u 5" "ERROR"
test_infix "3 n 10 / (-2) u 0" "ERROR"
test_infix "3 n 10 / 0 u 2" "ERROR"
test_infix "3 n 10 / -2 u 2" "ERROR"